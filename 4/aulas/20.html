<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="../../3/assets/css/style.css">
</head>

<body>
  <section class="container">
    <h1>Listando Alunos com Fotos</h1>
    <p>
      Esta é a parte final do upload de fotos, falta mesmo é resolver problema se caso o aluno não exista o sistema
      travará, para resouver isso é so ir em <strong>FotoController.js</strong>, esses erros nao enesperados
    </p>
    <div class="anotacoes">
      <span class="lembrete">
        FotoController.js
      </span> <br>
      import multer from 'multer'; <br>
      import multerConfig from '../config/multerConfig'; <br>
      import Foto from '../model/Foto'; <br>
      <br>
      const upload = multer(multerConfig).single('foto');<br>
      <br>

      class FotoController {<br>
      store(req, res) {<br>
      return upload(req, res, async (error) => {<br>
      if (error) {<br>
      return res.status(400).json({<br>
      errors: [error.code],<br>
      });<br>
      } <div class="marcada">
        try {<br><span style="background-color: blue; color: aliceblue;">//caso aluno exista</span> <br>
        const {<br>
        originalname,<br>
        filename<br>
        } = req.file;<br>
        const {<br>
        aluno_id<br>
        } = req.body;<br>
        const foto = await Foto.create({<br>
        originalname,<br>
        filename,<br>
        aluno_id<br>
        });<br>
        <br>
        return res.json(foto);<br>
        } catch (e) {<br> <span style="background-color: blue; color: aliceblue;">//caso aluno nao exista</span><br>
        return res.status(400).json({<br>
        errors: ["Aluno nao existe"]<br>
        })<br>
        }<br>
        });<br>
        }<br>
      </div>
      }

      export default new FotoController();
    </div>
    <h3>Agora é a listagem</h3>
    <p>
      primeiramente sera no <strong>AlunoController.js</strong>
    </p>
    <div class="exemplos">
      <span class="lembrete">
        AlunoController.js
      </span>
    </div>
    <p>Como criou se a relação entre aluno para foto será preciso ir em
      model/Aluno.js e adicionatr comando para q inverta a opção selecionada
      <div class="exemplos">
        <span class="lembrete">
          model/Aluno.js
        </span>
      </div>
    </p>
  </section>
</body>

</html>